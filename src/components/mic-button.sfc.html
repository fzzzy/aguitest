<template>
  <style>
    :host {
      display: inline-flex;
    }
    button {
      background: transparent;
      border: 2px solid transparent;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, transform 0.2s, border-color 0.2s;
      color: #666;
      flex-shrink: 0;
    }
    button:hover {
      border-color: #7dd3c0;
      color: #4a9b87;
    }
    :host(.recording) button {
      background: #ffebee;
      color: #d32f2f;
      animation: pulse 1.5s infinite;
    }
    :host(.recording) button:hover {
      background: #ffcdd2;
    }
    svg {
      fill: currentColor;
    }
    .stop-icon {
      display: none;
    }
    :host(.recording) .mic-icon {
      display: none;
    }
    :host(.recording) .stop-icon {
      display: block;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
  </style>
  <button>
    <svg class="mic-icon" viewBox="0 0 24 24" width="20" height="20">
      <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1V5z"/>
      <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
    </svg>
    <svg class="stop-icon" viewBox="0 0 24 24" width="20" height="20">
      <rect x="6" y="6" width="12" height="12" rx="2"/>
    </svg>
  </button>
</template>
<script>
export default class extends HTMLElement {
  connectedCallback() {
    this.attachShadow({ mode: 'open' });
    this.shadowRoot!.appendChild(template.content.cloneNode(true));
    const button = this.shadowRoot!.querySelector('button')!;

    // Forward clicks
    button.addEventListener('click', () => {
      this.dispatchEvent(new Event('click'));
    });
  }
}
</script>
