<template>
  <style>
    :host {
      display: flex;
      flex: 1;
    }
    input {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 24px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.3s;
      box-sizing: border-box;
    }
    input:focus {
      border-color: #7dd3c0;
    }
  </style>
  <input type="text" placeholder="Type your message...">
</template>
<script>
export default class extends HTMLElement {
  private input: HTMLInputElement | null = null;

  connectedCallback() {
    this.attachShadow({ mode: 'open' });
    this.shadowRoot!.appendChild(template.content.cloneNode(true));
    this.input = this.shadowRoot!.querySelector('input');

    // Forward keypress events
    this.input!.addEventListener('keypress', (e) => {
      this.dispatchEvent(new KeyboardEvent('keypress', {
        key: e.key,
        code: e.code,
        shiftKey: e.shiftKey,
        bubbles: true
      }));
    });
  }

  get value(): string {
    return this.input?.value ?? '';
  }

  set value(v: string) {
    if (this.input) {
      this.input.value = v;
    }
  }

  focus() {
    this.input?.focus();
  }
}
</script>
